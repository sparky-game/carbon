// SPDX-License-Identifier: AGPL-3.0-only
// Copyright (C) Wasym A. Alonso. All Rights Reserved.

#include <carbon.h>

#define TEST(name) CARBON_TEST(carbon_crypto, name)

TEST(base64) {
  const char *msg = "Hello";
  const usz msg_size = carbon_string_len(msg);
  usz b64_msg_size = 0;
  char *b64_msg = carbon_crypto_base64_encode((const u8 *) msg, msg_size, &b64_msg_size);
  carbon_should_be_s("SGVsbG8=", b64_msg);
  carbon_should_be(8, b64_msg_size);
  usz recv_msg_size = 0;
  u8 *recv_msg = carbon_crypto_base64_decode((const u8 *) b64_msg, &recv_msg_size);
  carbon_should_be_s(msg, recv_msg);
  carbon_should_be(msg_size, recv_msg_size);
  CBN_FREE(b64_msg);
  CBN_FREE(recv_msg);
  return CARBON_OK;
}

TEST(crc32) {
  const char *msg = "Hello";
  const usz msg_size = carbon_string_len(msg);
  u32 crc32_msg = carbon_crypto_crc32((const u8 *) msg, msg_size);
  carbon_should_be(0xf7d18982, crc32_msg);
  return CARBON_OK;
}

TEST(sha1_ShortMsg_0) {
  // Using official known-answer test (KAT) results as of FIPS 180-4:
  // <https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/shs/shabytetestvectors.zip>.
  // Specifically, this test uses `Len = 0` from `SHA1ShortMsg.rsp`.
  carbon_should_be_s("da39a3ee5e6b4b0d3255bfef95601890afd80709", carbon_crypto_sha1_as_hex_cstr(0, 0));
  return CARBON_OK;
}

TEST(sha1_ShortMsg_8_304) {
  // Using official known-answer test (KAT) results as of FIPS 180-4:
  // <https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/shs/shabytetestvectors.zip>.
  // Specifically, this test uses `Len = {8..304}` from `SHA1ShortMsg.rsp`.
#define KAT(hash, ...)                                                  \
  {                                                                     \
    const u8 msg[] = {__VA_ARGS__};                                     \
    carbon_should_be_s(hash, carbon_crypto_sha1_as_hex_cstr(msg, CARBON_ARRAY_LEN(msg))); \
  }

  KAT("c1dfd96eea8cc2b62785275bca38ac261256e278",
      0x36);
  KAT("0a1c2d555bbe431ad6288af5a54f93e0449c9232",
      0x19, 0x5a);
  KAT("bf36ed5d74727dfd5d7854ec6b1d49468d8ee8aa",
      0xdf, 0x4b, 0xd2);
  KAT("b78bae6d14338ffccfd5d5b5674a275f6ef9c717",
      0x54, 0x9e, 0x95, 0x9e);
  KAT("60b7d5bb560a1acf6fa45721bd0abb419a841a89",
      0xf7, 0xfb, 0x1b, 0xe2, 0x05);
  KAT("a6d338459780c08363090fd8fc7d28dc80e8e01f",
      0xc0, 0xe5, 0xab, 0xea, 0xea, 0x63);
  KAT("860328d80509500c1783169ebf0ba0c4b94da5e5",
      0x63, 0xbf, 0xc1, 0xed, 0x7f, 0x78, 0xab);
  KAT("24a2c34b976305277ce58c2f42d5092031572520",
      0x7e, 0x3d, 0x7b, 0x3e, 0xad, 0xa9, 0x88, 0x66);
  KAT("411ccee1f6e3677df12698411eb09d3ff580af97",
      0x9e, 0x61, 0xe5, 0x5d, 0x9e, 0xd3, 0x7b, 0x1c, 0x20);
  KAT("05c915b5ed4e4c4afffc202961f3174371e90b5c",
      0x97, 0x77, 0xcf, 0x90, 0xdd, 0x7c, 0x7e, 0x86, 0x35, 0x06);
  KAT("af320b42d7785ca6c8dd220463be23a2d2cb5afc",
      0x4e, 0xb0, 0x8c, 0x9e, 0x68, 0x3c, 0x94, 0xbe, 0xa0, 0x0d, 0xfa);
  KAT("9f4e66b6ceea40dcf4b9166c28f1c88474141da9",
      0x09, 0x38, 0xf2, 0xe2, 0xeb, 0xb6, 0x4f, 0x8a, 0xf8, 0xbb, 0xfc, 0x91);
  KAT("e6c4363c0852951991057f40de27ec0890466f01",
      0x74, 0xc9, 0x99, 0x6d, 0x14, 0xe8, 0x7d, 0x3e, 0x6c, 0xbe, 0xa7, 0x02, 0x9d);
  KAT("046a7b396c01379a684a894558779b07d8c7da20",
      0x51, 0xdc, 0xa5, 0xc0, 0xf8, 0xe5, 0xd4, 0x95, 0x96, 0xf3, 0x2d, 0x3e, 0xb8, 0x74);
  KAT("d58a262ee7b6577c07228e71ae9b3e04c8abcda9",
      0x3a, 0x36, 0xea, 0x49, 0x68, 0x48, 0x20, 0xa2, 0xad, 0xc7, 0xfc, 0x41, 0x75, 0xba, 0x78);
  KAT("a150de927454202d94e656de4c7c0ca691de955d",
      0x35, 0x52, 0x69, 0x4c, 0xdf, 0x66, 0x3f, 0xd9, 0x4b, 0x22, 0x47, 0x47, 0xac, 0x40, 0x6a, 0xaf);
  KAT("35a4b39fef560e7ea61246676e1b7e13d587be30",
      0xf2, 0x16, 0xa1, 0xcb, 0xde, 0x24, 0x46, 0xb1, 0xed, 0xf4, 0x1e, 0x93, 0x48, 0x1d, 0x33, 0xe2, 0xed);
  KAT("7ce69b1acdce52ea7dbd382531fa1a83df13cae7",
      0xa3, 0xcf, 0x71, 0x4b, 0xf1, 0x12, 0x64, 0x7e, 0x72, 0x7e, 0x8c, 0xfd, 0x46, 0x49, 0x9a, 0xcd, 0x35, 0xa6);
  KAT("b47be2c64124fa9a124a887af9551a74354ca411",
      0x14, 0x8d, 0xe6, 0x40, 0xf3, 0xc1, 0x15, 0x91, 0xa6, 0xf8, 0xc5, 0xc4, 0x86, 0x32, 0xc5, 0xfb, 0x79, 0xd3, 0xb7);
  KAT("8bb8c0d815a9c68a1d2910f39d942603d807fbcc",
      0x63, 0xa3, 0xcc, 0x83, 0xfd, 0x1e, 0xc1, 0xb6, 0x68, 0x0e, 0x99, 0x74, 0xa0, 0x51, 0x4e, 0x1a, 0x9e, 0xce, 0xbb,
      0x6a);
  KAT("b486f87fb833ebf0328393128646a6f6e660fcb1",
      0x87, 0x5a, 0x90, 0x90, 0x9a, 0x8a, 0xfc, 0x92, 0xfb, 0x70, 0x70, 0x04, 0x7e, 0x9d, 0x08, 0x1e, 0xc9, 0x2f, 0x3d,
      0x08, 0xb8);
  KAT("76159368f99dece30aadcfb9b7b41dab33688858",
      0x44, 0x4b, 0x25, 0xf9, 0xc9, 0x25, 0x9d, 0xc2, 0x17, 0x77, 0x2c, 0xc4, 0x47, 0x8c, 0x44, 0xb6, 0xfe, 0xff, 0x62,
      0x35, 0x36, 0x73);
  KAT("dbc1cb575ce6aeb9dc4ebf0f843ba8aeb1451e89",
      0x48, 0x73, 0x51, 0xc8, 0xa5, 0xf4, 0x40, 0xe4, 0xd0, 0x33, 0x86, 0x48, 0x3d, 0x5f, 0xe7, 0xbb, 0x66, 0x9d, 0x41,
      0xad, 0xcb, 0xfd, 0xb7);
  KAT("d7a98289679005eb930ab75efd8f650f991ee952",
      0x46, 0xb0, 0x61, 0xef, 0x13, 0x2b, 0x87, 0xf6, 0xd3, 0xb0, 0xee, 0x24, 0x62, 0xf6, 0x7d, 0x91, 0x09, 0x77, 0xda,
      0x20, 0xae, 0xd1, 0x37, 0x05);
  KAT("fda26fa9b4874ab701ed0bb64d134f89b9c4cc50",
      0x38, 0x42, 0xb6, 0x13, 0x7b, 0xb9, 0xd2, 0x7f, 0x3c, 0xa5, 0xba, 0xfe, 0x5b, 0xbb, 0x62, 0x85, 0x83, 0x44, 0xfe,
      0x4b, 0xa5, 0xc4, 0x15, 0x89, 0xa5);
  KAT("c2ff7ccde143c8f0601f6974b1903eb8d5741b6e",
      0x44, 0xd9, 0x1d, 0x3d, 0x46, 0x5a, 0x41, 0x11, 0x46, 0x2b, 0xa0, 0xc7, 0xec, 0x22, 0x3d, 0xa6, 0x73, 0x5f, 0x4f,
      0x52, 0x00, 0x45, 0x3c, 0xf1, 0x32, 0xc3);
  KAT("643c9dc20a929608f6caa9709d843ca6fa7a76f4",
      0xcc, 0xe7, 0x3f, 0x2e, 0xab, 0xcb, 0x52, 0xf7, 0x85, 0xd5, 0xa6, 0xdf, 0x63, 0xc0, 0xa1, 0x05, 0xf3, 0x4a, 0x91,
      0xca, 0x23, 0x7f, 0xe5, 0x34, 0xee, 0x39, 0x9d);
  KAT("509ef787343d5b5a269229b961b96241864a3d74",
      0x66, 0x4e, 0x6e, 0x79, 0x46, 0x83, 0x92, 0x03, 0x03, 0x7a, 0x65, 0xa1, 0x21, 0x74, 0xb2, 0x44, 0xde, 0x8c, 0xbc,
      0x6e, 0xc3, 0xf5, 0x78, 0x96, 0x7a, 0x84, 0xf9, 0xce);
  KAT("b61ce538f1a1e6c90432b233d7af5b6524ebfbe3",
      0x95, 0x97, 0xf7, 0x14, 0xb2, 0xe4, 0x5e, 0x33, 0x99, 0xa7, 0xf0, 0x2a, 0xec, 0x44, 0x92, 0x1b, 0xd7, 0x8b, 0xe0,
      0xfe, 0xfe, 0xe0, 0xc5, 0xe9, 0xb4, 0x99, 0x48, 0x8f, 0x6e);
  KAT("5b7b94076b2fc20d6adb82479e6b28d07c902b75",
      0x75, 0xc5, 0xad, 0x1f, 0x3c, 0xbd, 0x22, 0xe8, 0xa9, 0x5f, 0xc3, 0xb0, 0x89, 0x52, 0x67, 0x88, 0xfb, 0x4e, 0xbc,
      0xee, 0xd3, 0xe7, 0xd4, 0x44, 0x3d, 0xa6, 0xe0, 0x81, 0xa3, 0x5e);
  KAT("6066db99fc358952cf7fb0ec4d89cb0158ed91d7",
      0xdd, 0x24, 0x5b, 0xff, 0xe6, 0xa6, 0x38, 0x80, 0x66, 0x67, 0x76, 0x83, 0x60, 0xa9, 0x5d, 0x05, 0x74, 0xe1, 0xa0,
      0xbd, 0x0d, 0x18, 0x32, 0x9f, 0xdb, 0x91, 0x5c, 0xa4, 0x84, 0xac, 0x0d);
  KAT("b89962c94d60f6a332fd60f6f07d4f032a586b76",
      0x03, 0x21, 0x79, 0x4b, 0x73, 0x94, 0x18, 0xc2, 0x4e, 0x7c, 0x2e, 0x56, 0x52, 0x74, 0x79, 0x1c, 0x4b, 0xe7, 0x49,
      0x75, 0x2a, 0xd2, 0x34, 0xed, 0x56, 0xcb, 0x0a, 0x63, 0x47, 0x43, 0x0c, 0x6b);
  KAT("17bda899c13d35413d2546212bcd8a93ceb0657b",
      0x4c, 0x3d, 0xcf, 0x95, 0xc2, 0xf0, 0xb5, 0x25, 0x8c, 0x65, 0x1f, 0xcd, 0x1d, 0x51, 0xbd, 0x10, 0x42, 0x5d, 0x62,
      0x03, 0x06, 0x7d, 0x07, 0x48, 0xd3, 0x7d, 0x13, 0x40, 0xd9, 0xdd, 0xda, 0x7d, 0xb3);
  KAT("badcdd53fdc144b8bf2cc1e64d10f676eebe66ed",
      0xb8, 0xd1, 0x25, 0x82, 0xd2, 0x5b, 0x45, 0x29, 0x0a, 0x6e, 0x1b, 0xb9, 0x5d, 0xa4, 0x29, 0xbe, 0xfc, 0xfd, 0xbf,
      0x5b, 0x4d, 0xd4, 0x1c, 0xdf, 0x33, 0x11, 0xd6, 0x98, 0x8f, 0xa1, 0x7c, 0xec, 0x07, 0x23);
  KAT("01b4646180f1f6d2e06bbe22c20e50030322673a",
      0x6f, 0xda, 0x97, 0x52, 0x7a, 0x66, 0x25, 0x52, 0xbe, 0x15, 0xef, 0xae, 0xba, 0x32, 0xa3, 0xae, 0xa4, 0xed, 0x44,
      0x9a, 0xbb, 0x5c, 0x1e, 0xd8, 0xd9, 0xbf, 0xff, 0x54, 0x47, 0x08, 0xa4, 0x25, 0xd6, 0x9b, 0x72);
  KAT("10016dc3a2719f9034ffcc689426d28292c42fc9",
      0x09, 0xfa, 0x27, 0x92, 0xac, 0xbb, 0x24, 0x17, 0xe8, 0xed, 0x26, 0x90, 0x41, 0xcc, 0x03, 0xc7, 0x70, 0x06, 0x46,
      0x6e, 0x6e, 0x7a, 0xe0, 0x02, 0xcf, 0x3f, 0x1a, 0xf5, 0x51, 0xe8, 0xce, 0x0b, 0xb5, 0x06, 0xd7, 0x05);
  KAT("9f42fa2bce6ef021d93c6b2d902273797e426535",
      0x5e, 0xfa, 0x29, 0x87, 0xda, 0x0b, 0xaf, 0x0a, 0x54, 0xd8, 0xd7, 0x28, 0x79, 0x2b, 0xcf, 0xa7, 0x07, 0xa1, 0x57,
      0x98, 0xdc, 0x66, 0x74, 0x37, 0x54, 0x40, 0x69, 0x14, 0xd1, 0xcf, 0xe3, 0x70, 0x9b, 0x13, 0x74, 0xea, 0xeb);
  KAT("cdf48bacbff6f6152515323f9b43a286e0cb8113",
      0x28, 0x36, 0xde, 0x99, 0xc0, 0xf6, 0x41, 0xcd, 0x55, 0xe8, 0x9f, 0x5a, 0xf7, 0x66, 0x38, 0x94, 0x7b, 0x82, 0x27,
      0x37, 0x7e, 0xf8, 0x8b, 0xfb, 0xa6, 0x62, 0xe5, 0x68, 0x2b, 0xab, 0xc1, 0xec, 0x96, 0xc6, 0x99, 0x2b, 0xc9, 0xa0);

#undef KAT
  return CARBON_OK;
}

TEST(keccak256_ShortMsgKAT_0) {
  // Using official known-answer and Monte Carlo test results as of round 3
  // of the SHA-3 competition: <https://keccak.team/obsolete/KeccakKAT-3.zip>.
  // Specifically, this test uses `Len = 0` from `ShortMsgKAT_256.txt`.
  carbon_should_be_s("c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",
                     carbon_crypto_keccak256_as_hex_cstr(0, 0));
  return CARBON_OK;
}

TEST(keccak256_ShortMsgKAT_8_456) {
  // Using official known-answer and Monte Carlo test results as of round 3
  // of the SHA-3 competition: <https://keccak.team/obsolete/KeccakKAT-3.zip>.
  // Specifically, this test uses `Len = {8..456}` from `ShortMsgKAT_256.txt`.
#define KAT(hash, ...)                                                  \
  {                                                                     \
    const u8 msg[] = {__VA_ARGS__};                                     \
    carbon_should_be_s(hash, carbon_crypto_keccak256_as_hex_cstr(msg, CARBON_ARRAY_LEN(msg))); \
  }

  KAT("eead6dbfc7340a56caedc044696a168870549a6a7f6f56961e84a54bd9970b8a",
      0xcc);
  KAT("a8eaceda4d47b3281a795ad9e1ea2122b407baf9aabcb9e18b5717b7873537d2",
      0x41, 0xfb);
  KAT("627d7bc1491b2ab127282827b8de2d276b13d7d70fb4c5957fdf20655bc7ac30",
      0x1f, 0x87, 0x7c);
  KAT("b149e766d7612eaf7d55f74e1a4fdd63709a8115b14f61fcd22aa4abc8b8e122",
      0xc1, 0xec, 0xfd, 0xfc);
  KAT("67f05544dbe97d5d6417c1b1ea9bc0e3a99a541381d1cd9b08a9765687eb5bb4",
      0x21, 0xf1, 0x34, 0xac, 0x57);
  KAT("923062c4e6f057597220d182dbb10e81cd25f60b54005b2a75dd33d6dac518d0",
      0xc6, 0xf5, 0x0b, 0xb7, 0x4e, 0x29);
  KAT("feb8405dcd315d48c6cbf7a3504996de8e25cc22566efec67433712eda99894f",
      0x11, 0x97, 0x13, 0xcc, 0x83, 0xee, 0xef);
  KAT("e620d8f2982b24fedaaa3baa9b46c3f9ce204ee356666553ecb35e15c3ff9bf9",
      0x4a, 0x4f, 0x20, 0x24, 0x84, 0x51, 0x25, 0x26);
  KAT("9e03f7c9a3d055eca1d786ed6fb624d93f1cf0ac27f9c2b6c05e509fac9e7fca",
      0x1f, 0x66, 0xab, 0x41, 0x85, 0xed, 0x9b, 0x63, 0x75);
  KAT("caad8e1ed546630748a12f5351b518a9a431cda6ba56cbfc3ccbdd8aae5092f7",
      0xee, 0xd7, 0x42, 0x22, 0x27, 0x61, 0x3b, 0x6f, 0x53, 0xc9);
  KAT("d61708bdb3211a9aab28d4df01dfa4b29ed40285844d841042257e97488617b0",
      0xea, 0xee, 0xd5, 0xcd, 0xff, 0xd8, 0x9d, 0xec, 0xe4, 0x55, 0xf1);
  KAT("0f53be55990780b3fad9870f04f7d8153c3ae605c057c85abb5d71765043aaa8",
      0x5b, 0xe4, 0x3c, 0x90, 0xf2, 0x29, 0x02, 0xe4, 0xfe, 0x8e, 0xd2, 0xd3);
  KAT("32215ae88204a782b62d1810d945de49948de458600f5e1e3896ceca2ed3292b",
      0xa7, 0x46, 0x27, 0x32, 0x28, 0x12, 0x2f, 0x38, 0x1c, 0x3b, 0x46, 0xe4, 0xf1);
  KAT("9510da68e58ebb8d2ab9de8485bb408e358299a9c011ae8544b0d0faf9d4a4ea",
      0x3c, 0x58, 0x71, 0xcd, 0x61, 0x9c, 0x69, 0xa6, 0x3b, 0x54, 0x0e, 0xb5, 0xa6, 0x25);
  KAT("f20b3bcf743aa6fa084038520791c364cb6d3d1dd75841f8d7021cd98322bd8f",
      0xfa, 0x22, 0x87, 0x4b, 0xcc, 0x06, 0x88, 0x79, 0xe8, 0xef, 0x11, 0xa6, 0x9f, 0x07, 0x22);
  KAT("0e32defa2071f0b5ac0e6a108b842ed0f1d3249712f58ee0ddf956fe332a5f95",
      0x52, 0xa6, 0x08, 0xab, 0x21, 0xcc, 0xdd, 0x8a, 0x44, 0x57, 0xa5, 0x7e, 0xde, 0x78, 0x21, 0x76);
  KAT("9204550677b9aa770e6e93e319b9958540d54ff4dccb063c8561302cd8aff676",
      0x82, 0xe1, 0x92, 0xe4, 0x04, 0x3d, 0xdc, 0xd1, 0x2e, 0xcf, 0x52, 0x96, 0x9d, 0x0f, 0x80, 0x7e, 0xed);
  KAT("a6d5444cb7aa61f5106cdedb39d5e1dd7d608f102798d7e818ac87289123a1db",
      0x75, 0x68, 0x3d, 0xcb, 0x55, 0x61, 0x40, 0xc5, 0x22, 0x54, 0x3b, 0xb6, 0xe9, 0x09, 0x8b, 0x21, 0xa2, 0x1e);
  KAT("5796b993d0bd1257cf26782b4e58fafb22b0986d88684ab5a2e6cec6706275f9",
      0x06, 0xe4, 0xef, 0xe4, 0x50, 0x35, 0xe6, 0x1f, 0xaa, 0xf4, 0x28, 0x7b, 0x4d, 0x8d, 0x1f, 0x12, 0xca, 0x97, 0xe5);
  KAT("cfbe73c6585be6204dd473abe356b539477174c4b770bfc91e9fdbcbc57086e6",
      0xe2, 0x61, 0x93, 0x98, 0x9d, 0x06, 0x56, 0x8f, 0xe6, 0x88, 0xe7, 0x55, 0x40, 0xae, 0xa0, 0x67, 0x47, 0xd9, 0xf8,
      0x51);
  KAT("31c8006b0ec35e690674297cb27476db6066b5fa9825c60728e9e0bb338fb7c3",
      0xd8, 0xdc, 0x8f, 0xde, 0xfb, 0xdc, 0xe9, 0xd4, 0x4e, 0x4c, 0xba, 0xfe, 0x78, 0x44, 0x7b, 0xae, 0x3b, 0x54, 0x36,
      0x10, 0x2a);
  KAT("3b8fa3904fe1b837565a50d0fbf03e487d6d72fc3cea41adcce33df1b835d247",
      0x57, 0x08, 0x5f, 0xd7, 0xe1, 0x42, 0x16, 0xab, 0x10, 0x2d, 0x83, 0x17, 0xb0, 0xcb, 0x33, 0x8a, 0x78, 0x6d, 0x5f,
      0xc3, 0x2d, 0x8f);
  KAT("37febc4df9d50daeabd0caa6578812a687e55f1ac0b109d2512810d00548c85b",
      0xa0, 0x54, 0x04, 0xdf, 0x5d, 0xbb, 0x57, 0x69, 0x7e, 0x2c, 0x16, 0xfa, 0x29, 0xde, 0xfa, 0xc8, 0xab, 0x35, 0x60,
      0xd6, 0x12, 0x6f, 0xa0);
  KAT("2329810b5a4735bcd49c10e6456c0b1ded5eac258af47cbb797ca162ab6d1ba8",
      0xae, 0xcb, 0xb0, 0x27, 0x59, 0xf7, 0x43, 0x3d, 0x6f, 0xcb, 0x06, 0x96, 0x3c, 0x74, 0x06, 0x1c, 0xd8, 0x3b, 0x5b,
      0x3f, 0xfa, 0x6f, 0x13, 0xc6);
  KAT("6fffa070b865be3ee766dc2db49b6aa55c369f7de3703ada2612d754145c01e6",
      0xaa, 0xfd, 0xc9, 0x24, 0x3d, 0x3d, 0x4a, 0x09, 0x65, 0x58, 0xa3, 0x60, 0xcc, 0x27, 0xc8, 0xd8, 0x62, 0xf0, 0xbe,
      0x73, 0xdb, 0x5e, 0x88, 0xaa, 0x55);
  KAT("b30761c053e926f150b9dce7e005b4d87811ccfb9e3b6edb0221022f01711cf0",
      0x7b, 0xc8, 0x48, 0x67, 0xf6, 0xf9, 0xe9, 0xfd, 0xc3, 0xe1, 0x04, 0x6c, 0xae, 0x3a, 0x52, 0xc7, 0x7e, 0xd4, 0x85,
      0x86, 0x0e, 0xe2, 0x60, 0xe3, 0x0b, 0x15);
  KAT("04f1b3c1e25ba5d012e22ad144e5a8719d94322d05ad9ef61e7db49b59959b3a",
      0xfa, 0xc5, 0x23, 0x57, 0x5a, 0x99, 0xec, 0x48, 0x27, 0x9a, 0x7a, 0x45, 0x9e, 0x98, 0xff, 0x90, 0x19, 0x18, 0xa4,
      0x75, 0x03, 0x43, 0x27, 0xef, 0xb5, 0x58, 0x43);
  KAT("aeef4b4da420834ffced26db291248fb2d01e765e2b0564057f8e6c2030ac37f",
      0x0f, 0x8b, 0x2d, 0x8f, 0xcf, 0xd9, 0xd6, 0x8c, 0xff, 0xc1, 0x7c, 0xcf, 0xb1, 0x17, 0x70, 0x9b, 0x53, 0xd2, 0x64,
      0x62, 0xa3, 0xf3, 0x46, 0xfb, 0x7c, 0x79, 0xb8, 0x5e);
  KAT("03d26aeeb4a7bdddbff7cff667198c425941a2776922df2bec545f5304e2c61c",
      0xa9, 0x63, 0xc3, 0xe8, 0x95, 0xff, 0x5a, 0x0b, 0xe4, 0x82, 0x44, 0x00, 0x51, 0x8d, 0x81, 0x41, 0x2f, 0x87, 0x5f,
      0xa5, 0x05, 0x21, 0xe2, 0x6e, 0x85, 0xea, 0xc9, 0x0c, 0x04);
  KAT("435cfc0d1afd8d5509a9ccbf49706575038685bf08db549d9714548240463ee9",
      0x03, 0xa1, 0x86, 0x88, 0xb1, 0x0c, 0xc0, 0xed, 0xf8, 0x3a, 0xdf, 0x0a, 0x84, 0x80, 0x8a, 0x97, 0x18, 0x38, 0x3c,
      0x40, 0x70, 0xc6, 0xc4, 0xf2, 0x95, 0x09, 0x86, 0x99, 0xac, 0x2c);
  KAT("d477fb02caaa95b3280ec8ee882c29d9e8a654b21ef178e0f97571bf9d4d3c1c",
      0x84, 0xfb, 0x51, 0xb5, 0x17, 0xdf, 0x6c, 0x5a, 0xcc, 0xb5, 0xd0, 0x22, 0xf8, 0xf2, 0x8d, 0xa0, 0x9b, 0x10, 0x23,
      0x2d, 0x42, 0x32, 0x0f, 0xfc, 0x32, 0xdb, 0xec, 0xc3, 0x83, 0x5b, 0x29);
  KAT("24dd2ee02482144f539f810d2caa8a7b75d0fa33657e47932122d273c3f6f6d1",
      0x9f, 0x2f, 0xcc, 0x7c, 0x90, 0xde, 0x09, 0x0d, 0x6b, 0x87, 0xcd, 0x7e, 0x97, 0x18, 0xc1, 0xea, 0x6c, 0xb2, 0x11,
      0x18, 0xfc, 0x2d, 0x5d, 0xe9, 0xf9, 0x7e, 0x5d, 0xb6, 0xac, 0x1e, 0x9c, 0x10);
  KAT("e78c421e6213aff8de1f025759a4f2c943db62bbde359c8737e19b3776ed2dd2",
      0xde, 0x8f, 0x1b, 0x3f, 0xaa, 0x4b, 0x70, 0x40, 0xed, 0x45, 0x63, 0xc3, 0xb8, 0xe5, 0x98, 0x25, 0x31, 0x78, 0xe8,
      0x7e, 0x4d, 0x0d, 0xf7, 0x5e, 0x4f, 0xf2, 0xf2, 0xde, 0xdd, 0x5a, 0x0b, 0xe0, 0x46);
  KAT("cce3e3d498328a4d9c5b4dbf9a1209628ab82621ad1a0d0a18680362889e6164",
      0x62, 0xf1, 0x54, 0xec, 0x39, 0x4d, 0x0b, 0xc7, 0x57, 0xd0, 0x45, 0xc7, 0x98, 0xc8, 0xb8, 0x7a, 0x00, 0xe0, 0x65,
      0x5d, 0x04, 0x81, 0xa7, 0xd2, 0xd9, 0xfb, 0x58, 0xd9, 0x3a, 0xed, 0xc6, 0x76, 0xb5, 0xa0);
  KAT("f871db93c5c92ecd65d4edb96fcb12e4729bc2a1899f7fb029f50bff431cbb72",
      0xb2, 0xdc, 0xfe, 0x9f, 0xf1, 0x9e, 0x2b, 0x23, 0xce, 0x7d, 0xa2, 0xa4, 0x20, 0x7d, 0x3e, 0x5e, 0xc7, 0xc6, 0x11,
      0x2a, 0x8a, 0x22, 0xae, 0xc9, 0x67, 0x5a, 0x88, 0x63, 0x78, 0xe1, 0x4e, 0x5b, 0xfb, 0xad, 0x4e);
  KAT("4eb143477431df019311aed936cab91a912ec1e6868b71e9eddb777408d4af34",
      0x47, 0xf5, 0x69, 0x7a, 0xc8, 0xc3, 0x14, 0x09, 0xc0, 0x86, 0x88, 0x27, 0x34, 0x7a, 0x61, 0x3a, 0x35, 0x62, 0x04,
      0x1c, 0x63, 0x3c, 0xf1, 0xf1, 0xf8, 0x68, 0x65, 0xa5, 0x76, 0xe0, 0x28, 0x35, 0xed, 0x2c, 0x24, 0x92);
  KAT("9a0c1d50a59dbf657f6713c795ed14e1f23b4eaa137c5540aacdb0a7e32c29fc",
      0x51, 0x2a, 0x6d, 0x29, 0x2e, 0x67, 0xec, 0xb2, 0xfe, 0x48, 0x6b, 0xfe, 0x92, 0x66, 0x09, 0x53, 0xa7, 0x54, 0x84,
      0xff, 0x4c, 0x4f, 0x2e, 0xca, 0x2b, 0x0a, 0xf0, 0xed, 0xcd, 0xd4, 0x33, 0x9c, 0x6b, 0x2e, 0xe4, 0xe5, 0x42);
  KAT("ba062e5d370216d11985c4ca7a2658ddc7328b4be4b40a52dd8fa3ca662f09d1",
      0x97, 0x3c, 0xf2, 0xb4, 0xdc, 0xf0, 0xbf, 0xa8, 0x72, 0xb4, 0x11, 0x94, 0xcb, 0x05, 0xbb, 0x4e, 0x16, 0x76, 0x0a,
      0x18, 0x40, 0xd8, 0x34, 0x33, 0x01, 0x80, 0x25, 0x76, 0x19, 0x7e, 0xc1, 0x9e, 0x2a, 0x14, 0x93, 0xd8, 0xf4, 0xfb);
  KAT("3a083ae163df42bd51b9c664bee9dc4362f16e63383df16473df71be6dd40c1c",
      0x80, 0xbe, 0xeb, 0xcd, 0x2e, 0x3f, 0x8a, 0x94, 0x51, 0xd4, 0x49, 0x99, 0x61, 0xc9, 0x73, 0x1a, 0xe6, 0x67, 0xcd,
      0xc2, 0x4e, 0xa0, 0x20, 0xce, 0x3b, 0x9a, 0xa4, 0xbb, 0xc0, 0xa7, 0xf7, 0x9e, 0x30, 0xa9, 0x34, 0x46, 0x7d, 0xa4,
      0xb0);
  KAT("4876e273ac00942576d9608d5b63ecc9a3e75d5e0c42c6abdbcde037785af9a7",
      0x7a, 0xba, 0xa1, 0x2e, 0xc2, 0xa7, 0x34, 0x76, 0x74, 0xe4, 0x44, 0x14, 0x0a, 0xe0, 0xfb, 0x65, 0x9d, 0x08, 0xe1,
      0xc6, 0x6d, 0xec, 0xd8, 0xd6, 0xea, 0xe9, 0x25, 0xfa, 0x45, 0x1d, 0x65, 0xf3, 0xc0, 0x30, 0x8e, 0x29, 0x44, 0x6b,
      0x8e, 0xd3);
  KAT("4797ba1c7ab7197050d6b2e506f2df4550e4b673df78f18c465424e48df5e997",
      0xc8, 0x8d, 0xee, 0x99, 0x27, 0x67, 0x9b, 0x8a, 0xf4, 0x22, 0xab, 0xcb, 0xac, 0xf2, 0x83, 0xb9, 0x04, 0xff, 0x31,
      0xe1, 0xca, 0xc5, 0x8c, 0x78, 0x19, 0x80, 0x9f, 0x65, 0xd5, 0x80, 0x7d, 0x46, 0x72, 0x3b, 0x20, 0xf6, 0x7b, 0xa6,
      0x10, 0xc2, 0xb7);
  KAT("41c91be98c5813a4c5d8ae7c29b9919c1cc95b4a05f82433948cb99d9a6d039c",
      0x01, 0xe4, 0x3f, 0xe3, 0x50, 0xfc, 0xec, 0x45, 0x0e, 0xc9, 0xb1, 0x02, 0x05, 0x3e, 0x6b, 0x5d, 0x56, 0xe0, 0x98,
      0x96, 0xe0, 0xdd, 0xd9, 0x07, 0x4f, 0xe1, 0x38, 0xe6, 0x03, 0x82, 0x10, 0x27, 0x0c, 0x83, 0x4c, 0xe6, 0xea, 0xdc,
      0x2b, 0xb8, 0x6b, 0xf6);
  KAT("ee354290e3f9ce9123c49ba616e1a2684a90f3ddd84e73a1d2c232f740412b18",
      0x33, 0x70, 0x23, 0x37, 0x0a, 0x48, 0xb6, 0x2e, 0xe4, 0x35, 0x46, 0xf1, 0x7c, 0x4e, 0xf2, 0xbf, 0x8d, 0x7e, 0xcd,
      0x1d, 0x49, 0xf9, 0x0b, 0xab, 0x60, 0x4b, 0x83, 0x9c, 0x2e, 0x6e, 0x5b, 0xd2, 0x15, 0x40, 0xd2, 0x9b, 0xa2, 0x7a,
      0xb8, 0xe3, 0x09, 0xa4, 0xb7);
  KAT("fbec0b6d71696eede900b77aa6d7d25f4ab45df8961ca9c8b3f4f9b51af983ab",
      0x68, 0x92, 0x54, 0x0f, 0x96, 0x4c, 0x8c, 0x74, 0xbd, 0x2d, 0xb0, 0x2c, 0x0a, 0xd8, 0x84, 0x51, 0x0c, 0xb3, 0x8a,
      0xfd, 0x44, 0x38, 0xaf, 0x31, 0xfc, 0x91, 0x27, 0x56, 0xf3, 0xef, 0xec, 0x6b, 0x32, 0xb5, 0x8e, 0xbc, 0x38, 0xfc,
      0x2a, 0x6b, 0x91, 0x35, 0x96, 0xa8);
  KAT("9d24aeea08f9a4b5fb8b6de85a2296f5f4108ddd1eea4f8ee58819cf84edb765",
      0xf5, 0x96, 0x1d, 0xfd, 0x2b, 0x1f, 0xff, 0xfd, 0xa4, 0xff, 0xbf, 0x30, 0x56, 0x0c, 0x16, 0x5b, 0xfe, 0xda, 0xb8,
      0xce, 0x0b, 0xe5, 0x25, 0x84, 0x5d, 0xeb, 0x8d, 0xc6, 0x10, 0x04, 0xb7, 0xdb, 0x38, 0x46, 0x72, 0x05, 0xf5, 0xdc,
      0xfb, 0x34, 0xa2, 0xac, 0xfe, 0x96, 0xc0);
  KAT("732034cae3ff1116f07fc18b5a26ef8faf3fe75d3dbca05e48795365e0a17c40",
      0xca, 0x06, 0x1a, 0x2e, 0xb6, 0xce, 0xed, 0x88, 0x81, 0xce, 0x20, 0x57, 0x17, 0x2d, 0x86, 0x9d, 0x73, 0xa1, 0x95,
      0x1e, 0x63, 0xd5, 0x72, 0x61, 0x38, 0x4b, 0x80, 0xce, 0xb5, 0x45, 0x1e, 0x77, 0xb0, 0x6c, 0xf0, 0xf5, 0xa0, 0xea,
      0x15, 0xca, 0x90, 0x7e, 0xe1, 0xc2, 0x7e, 0xba);
  KAT("deac521805bc6a97c0870e9e225d1c4b2fd8f3a9a7f6b39e357c26414821e2dd",
      0x17, 0x43, 0xa7, 0x72, 0x51, 0xd6, 0x92, 0x42, 0x75, 0x0c, 0x4f, 0x11, 0x40, 0x53, 0x2c, 0xd3, 0xc3, 0x3f, 0x9b,
      0x5c, 0xcd, 0xf7, 0x51, 0x4e, 0x85, 0x84, 0xd4, 0xa5, 0xf9, 0xfb, 0xd7, 0x30, 0xbc, 0xf8, 0x4d, 0x0d, 0x47, 0x26,
      0x36, 0x4b, 0x9b, 0xf9, 0x5a, 0xb2, 0x51, 0xd9, 0xbb);
  KAT("ad55537347b20d9fca02683e6de1032ec10eb84da4cbd501e49744a666292edf",
      0xd8, 0xfa, 0xba, 0x1f, 0x51, 0x94, 0xc4, 0xdb, 0x5f, 0x17, 0x6f, 0xab, 0xff, 0xf8, 0x56, 0x92, 0x4e, 0xf6, 0x27,
      0xa3, 0x7c, 0xd0, 0x8c, 0xf5, 0x56, 0x08, 0xbb, 0xa8, 0xf1, 0xe3, 0x24, 0xd7, 0xc7, 0xf1, 0x57, 0x29, 0x8e, 0xab,
      0xc4, 0xdc, 0xe7, 0xd8, 0x9c, 0xe5, 0x16, 0x24, 0x99, 0xf9);
  KAT("b1f990204bf630569a3edc634864274786f40ce1c57165ee32d0e29f5d0c6851",
      0xbe, 0x96, 0x84, 0xbe, 0x70, 0x34, 0x08, 0x60, 0x37, 0x3c, 0x9c, 0x48, 0x2b, 0xa5, 0x17, 0xe8, 0x99, 0xfc, 0x81,
      0xba, 0xaa, 0x12, 0xe5, 0xc6, 0xd7, 0x72, 0x79, 0x75, 0xd1, 0xd4, 0x1b, 0xa8, 0xbe, 0xf7, 0x88, 0xcd, 0xb5, 0xcf,
      0x46, 0x06, 0xc9, 0xc1, 0xc7, 0xf6, 0x1a, 0xed, 0x59, 0xf9, 0x7d);
  KAT("fa460cd51bc611786d364fcabe39052bcd5f009edfa81f4701c5b22b729b0016",
      0x7e, 0x15, 0xd2, 0xb9, 0xea, 0x74, 0xca, 0x60, 0xf6, 0x6c, 0x8d, 0xfa, 0xb3, 0x77, 0xd9, 0x19, 0x8b, 0x7b, 0x16,
      0xde, 0xb6, 0xa1, 0xba, 0x0e, 0xa3, 0xc7, 0xee, 0x20, 0x42, 0xf8, 0x9d, 0x37, 0x86, 0xe7, 0x79, 0xcf, 0x05, 0x3c,
      0x77, 0x78, 0x5a, 0xa9, 0xe6, 0x92, 0xf8, 0x21, 0xf1, 0x4a, 0x7f, 0x51);
  KAT("f7b0fe5a69ff44060d4f6ad2486e6cde9ed679af9aa1ada613e4cc392442beb5",
      0x9A, 0x21, 0x9B, 0xE4, 0x37, 0x13, 0xBD, 0x57, 0x80, 0x15, 0xE9, 0xFD, 0xA6, 0x6C, 0x0F, 0x2D, 0x83, 0xCA, 0xC5,
      0x63, 0xB7, 0x76, 0xAB, 0x9F, 0x38, 0xF3, 0xE4, 0xF7, 0xEF, 0x22, 0x9C, 0xB4, 0x43, 0x30, 0x4F, 0xBA, 0x40, 0x1E,
      0xFB, 0x2B, 0xDB, 0xD7, 0xEC, 0xE9, 0x39, 0x10, 0x22, 0x98, 0x65, 0x1C, 0x86);
  KAT("24204d491f202534859fc0a208237184471a2d801fb3b934d0968d0d843d0345",
      0xc8, 0xf2, 0xb6, 0x93, 0xbd, 0x0d, 0x75, 0xef, 0x99, 0xca, 0xeb, 0xdc, 0x22, 0xad, 0xf4, 0x08, 0x8a, 0x95, 0xa3,
      0x54, 0x2f, 0x63, 0x72, 0x03, 0xe2, 0x83, 0xbb, 0xc3, 0x26, 0x87, 0x80, 0xe7, 0x87, 0xd6, 0x8d, 0x28, 0xcc, 0x38,
      0x97, 0x45, 0x2f, 0x6a, 0x22, 0xaa, 0x85, 0x73, 0xcc, 0xeb, 0xf2, 0x45, 0x97, 0x2a);
  KAT("81147cba0647eee78c4784874c0557621a138ca781fb6f5dcd0d9c609af56f35",
      0xec, 0x0f, 0x99, 0x71, 0x10, 0x16, 0xc6, 0xa2, 0xa0, 0x7a, 0xd8, 0x0d, 0x16, 0x42, 0x75, 0x06, 0xce, 0x6f, 0x44,
      0x10, 0x59, 0xfd, 0x26, 0x94, 0x42, 0xba, 0xaa, 0x28, 0xc6, 0xca, 0x03, 0x7b, 0x22, 0xee, 0xac, 0x49, 0xd5, 0xd8,
      0x94, 0xc0, 0xbf, 0x66, 0x21, 0x9f, 0x2c, 0x08, 0xe9, 0xd0, 0xe8, 0xab, 0x21, 0xde, 0x52);
  KAT("5b6d7eda559574fae882e6266f4c2be362133e44b5a947ecb6e75db9fc8567e0",
      0x0d, 0xc4, 0x51, 0x81, 0x33, 0x7c, 0xa3, 0x2a, 0x82, 0x22, 0xfe, 0x7a, 0x3b, 0xf4, 0x2f, 0xc9, 0xf8, 0x97, 0x44,
      0x25, 0x9c, 0xff, 0x65, 0x35, 0x04, 0xd6, 0x05, 0x1f, 0xe8, 0x4b, 0x1a, 0x7f, 0xfd, 0x20, 0xcb, 0x47, 0xd4, 0x69,
      0x6c, 0xe2, 0x12, 0xa6, 0x86, 0xbb, 0x9b, 0xe9, 0xa8, 0xab, 0x1c, 0x69, 0x7b, 0x6d, 0x6a, 0x33);
  KAT("86f87e75c87f9be39e4aa6d0c5a37a5964d6ffdc462525c0642c9db010de38ee",
      0xde, 0x28, 0x6b, 0xa4, 0x20, 0x6e, 0x8b, 0x00, 0x57, 0x14, 0xf8, 0x0f, 0xb1, 0xcd, 0xfa, 0xeb, 0xde, 0x91, 0xd2,
      0x9f, 0x84, 0x60, 0x3e, 0x4a, 0x3e, 0xbc, 0x04, 0x68, 0x6f, 0x99, 0xa4, 0x6c, 0x9e, 0x88, 0x0b, 0x96, 0xc5, 0x74,
      0x82, 0x55, 0x82, 0xe8, 0x81, 0x2a, 0x26, 0xe5, 0xa8, 0x57, 0xff, 0xc6, 0x57, 0x9f, 0x63, 0x74, 0x2f);
  KAT("959fe007b57c2947c36d1d66cc0808d80db7df45d68a34852b70d2dda192c25c",
      0xee, 0xbc, 0xc1, 0x80, 0x57, 0x25, 0x2c, 0xbf, 0x3f, 0x9c, 0x07, 0x0f, 0x1a, 0x73, 0x21, 0x33, 0x56, 0xd5, 0xd4,
      0xbc, 0x19, 0xac, 0x2a, 0x41, 0x1e, 0xc8, 0xcd, 0xee, 0xe7, 0xa5, 0x71, 0xe2, 0xe2, 0x0e, 0xaf, 0x61, 0xfd, 0x0c,
      0x33, 0xa0, 0xff, 0xeb, 0x29, 0x7d, 0xdb, 0x77, 0xa9, 0x7f, 0x0a, 0x41, 0x53, 0x47, 0xdb, 0x66, 0xbc, 0xaf);
  KAT("1a93567eebc41cc44d9346cde646005d3e82de8eeeb131e9c1f6d1e4afd260f7",
      0x41, 0x6b, 0x5c, 0xdc, 0x9f, 0xe9, 0x51, 0xbd, 0x36, 0x1b, 0xd7, 0xab, 0xfc, 0x12, 0x0a, 0x50, 0x54, 0x75, 0x8e,
      0xba, 0x88, 0xfd, 0xd6, 0x8f, 0xd8, 0x4e, 0x39, 0xd3, 0xb0, 0x9a, 0xc2, 0x54, 0x97, 0xd3, 0x6b, 0x43, 0xcb, 0xe7,
      0xb8, 0x5a, 0x6a, 0x3c, 0xeb, 0xda, 0x8d, 0xb4, 0xe5, 0x54, 0x9c, 0x3e, 0xe5, 0x1b, 0xb6, 0xfc, 0xb6, 0xac, 0x1e);

#undef KAT
  return CARBON_OK;
}

#undef TEST
